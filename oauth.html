<head>
<link rel="stylesheet" href="//gnjo.github.io/small.css">
 <script src="https://cdnjs.cloudflare.com/ajax/libs/superagent/3.8.2/superagent.min.js"></script>
</head>
<body>
<a href="https://github.com/login/oauth/authorize?client_id=a03db186a7c9b816b17e">oauth</a>
<script>
 
 var log =(str)=>{
 let el =document.createElement('li')
 ;
 el.innerHTML=`${str}=>${JSON.stringify(str,null,2)}`;
 document.body.appendChild(el);
}


var req = window.superagent;

//https://gnjo.github.io/githubdemo/oauth.html?code=ec570bdff21e498ed153
var code = location.search.split('code=').slice(1,2)[0];
  let cid ='a03db186a7c9b816b17e'
  ,cse ='9ff5ffbd1dd68602940ffd5bf91d3ae4f347ba1c'
  ;
 //g('ec570bdff21e498ed153',cid,cse)
if(code){
  g(code,cid,cse).then((d)=>{console.log(d); log(d) }).catch((d)=>{console.log('error',d); });
}

function g(code,cid,cse){
 let url =`https://github.com/login/oauth/access_token?code=${code}&client_id=${cid}&client_secret=${cse}`
 ;
  let xy= "http://cors.io/?u="
 return req
   .post(xy+url)
//   .post(url)
.withCredentials()
   .set('Accept', 'application/json')
   .set('content-type','text/plain') 
   .then(function(res) {
      return res.body;
   })
}
 
</script> 
</body>
